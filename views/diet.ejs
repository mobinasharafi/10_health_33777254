<!DOCTYPE html>
<html>
<head>
    <title>Dietary Approach Explorer</title>
    <link rel="stylesheet" href="/css/style.css">

    <style>
        .tiny-input {
            width: 45px;
            font-size: 0.85rem;
            padding: 2px 4px;
        }

        .tiny-label {
            font-size: 0.85rem;
        }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body>

<nav>
    <a href="/">Home</a>
    <a href="/about">About</a>

    <% if (session && session.userId) { %>
        <a href="/records">View My Records</a>
        <a href="/profile">Profile</a>
        <a href="/vision">Vision Board</a>
        <a href="/diet">Diet Explorer</a>
        <a href="/logout">Logout</a>
    <% } else { %>
        <a href="/login">Login</a>
        <a href="/register">Register</a>
        <a href="/diet">Diet Explorer</a>
    <% } %>
</nav>

<h1>Dietary Approach Explorer</h1>

<p>
This feature suggests dietary approaches based on your goal, body information, and preferences.
It does not provide medical advice.
</p>

<% if (user) { %>
    <p><strong>Your goal:</strong> <%= user.goal %></p>
    <p><strong>Your BMI category:</strong> <%= user.bmi_category %></p>
<% } %>

<form action="/diet" method="POST">

<% if (!user) { %>

    <!-- Ask for body data only if user is logged out -->
    <label class="tiny-label">Height (cm):</label>
    <input
        type="number"
        name="height_cm"
        class="tiny-input"
        min="80"
        max="250"
        required
    >

    <br><br>

    <label class="tiny-label">Weight (kg):</label>
    <input
        type="number"
        name="weight_kg"
        class="tiny-input"
        min="20"
        max="300"
        required
    >

    <br><br>

    <label>Your goal:</label>
    <select name="goal_override" required>
        <option value="Weight gain">Weight gain</option>
        <option value="Weight loss">Weight loss</option>
        <option value="Improve overall health/fitness">Improve overall health/fitness</option>
        <option value="Building a better physique">Building a better physique</option>
    </select>

    <br><br>

<% } %>

<h3>Food preferences</h3>

<label><input type="checkbox" name="vegetarian"> Enjoys plant-heavy meals</label><br>
<label><input type="checkbox" name="meat"> Feels better eating meat regularly</label><br>
<label><input type="checkbox" name="sweet"> Has a sweet tooth</label><br>
<label><input type="checkbox" name="hearty"> Craves filling, hearty meals</label><br>
<label><input type="checkbox" name="light"> Prefers light meals, hates feeling too full</label><br>
<label><input type="checkbox" name="routine"> Enjoys eating the same things often</label><br>
<label><input type="checkbox" name="variety"> Gets bored easily and needs variety</label><br>
<label><input type="checkbox" name="fuel"> Eats for fuel more than pleasure</label><br><br>

<button type="submit">Show suitable options</button>
</form>

<% if (blockedMessage) { %>
    <p style="color:#7a0000; font-weight:bold;">
        <%= blockedMessage %>
        <% if (user) { %>
            <br>
            <a href="/profile">Update your profile information</a>
        <% } %>
    </p>
<% } %>

<% if (suggestions) { %>
    <hr>
    <h2>Your suggested dietary approaches</h2>

    <% suggestions.forEach(d => { %>
        <div style="margin-bottom:20px;">
            <strong><%= d.name %></strong>
            <p><%= d.description %></p>

            <a href="<%= d.link %>" target="_blank">
                Learn more about this approach
            </a>
        </div>
    <% }) %>
<% } %>

</body>
</html>